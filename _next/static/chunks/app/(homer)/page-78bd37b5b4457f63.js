(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[625],{956:function(e,t,a){Promise.resolve().then(a.bind(a,5207))},5207:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return page}});var r=a(7437),s=a(8089),n=a(7801),i=a(7916),o=a(6427),l=a(4312),c=a(4387),d=a(2265),u=a(6282),h=a(2838),m=a(7833),p=a(251),g=a(4033),f=a(3968),x=a(5397),b=a(9851),v=a(753),y=a(5409),j=a(7698),w=a(9621),create_new_request=e=>{let{visible:t,onHide:a,onSubmit:n,onCancel:i}=e,[u,h]=(0,d.useState)(!1),m=(0,d.useRef)(null),{currentRequest:p,setCurrentRequest:g,saveRequest:C,fetchBrandsForCurrentRequest:q,brands:R,setBrands:E,selectedBrands:N,setSelectedBrands:P,getEmptyRequest:k}=(0,w.useRequest)(),onDialogHide=()=>{g(k()),E([]),P([]),h(!1),a()},onInputChange=(e,t)=>{let a=e.target&&e.target.value||"",r={...p};r["".concat(t)]=a,g(r)},onInputBooleanChange=(e,t)=>{let a=e.target&&e.target.checked||!1,r={...p};r["".concat(t)]=a,g(r)},onInputNumberChange=(e,t)=>{let a=e.target&&e.target.value||0,r={...p};r["".concat(t)]=a,g(r)},selectBrands=e=>{let t={...p};t.brands=e.map(e=>e.brand),g(t),P(e)},S=(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.z,{label:(0,f.t)("dialog.common.cancel"),icon:"pi pi-times",text:!0,onClick:()=>{onDialogHide(),i()}}),(0,r.jsx)(s.z,{label:(0,f.t)("dialog.common.save"),icon:"pi pi-check",text:!0,onClick:()=>{if(h(!0),p.number.trim()){var e,t;p.id?null===(t=m.current)||void 0===t||t.show({severity:"success",summary:"".concat((0,f.t)("toast.summary.successful")),detail:"".concat((0,f.t)("toast.details.updated")),life:3e3}):null===(e=m.current)||void 0===e||e.show({severity:"success",summary:"".concat((0,f.t)("toast.summary.successful")),detail:"".concat((0,f.t)("toast.details.created")),life:3e3}),C(),onDialogHide(),n()}}})]});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.F,{ref:m,position:"bottom-right"}),(0,r.jsxs)(x.V,{visible:t,onHide:onDialogHide,header:(0,f.t)("dialog.new.header"),modal:!0,footer:S,className:"p-fluid",children:[(0,r.jsxs)("div",{className:"field",children:[(0,r.jsx)("label",{htmlFor:"number",children:(0,f.t)("dialog.new.labels.number")}),(0,r.jsx)(o.o,{id:"number",value:p.number,onChange:e=>onInputChange(e,"number"),required:!0,autoFocus:!0,className:(0,b.AK)({"p-invalid":u&&!p.number})}),u&&!p.number&&(0,r.jsx)("div",{className:"text-sm p-invalid",children:(0,f.t)("dialog.new.errors.number")})]}),(0,r.jsx)("div",{className:"field",children:(0,r.jsxs)("div",{className:"flex align-items-center",children:[(0,r.jsx)(l.X,{inputId:"isOriginal",name:"isOriginal",onChange:e=>onInputBooleanChange(e,"original"),checked:p.original}),(0,r.jsx)("label",{htmlFor:"isOriginal",className:"ml-2",children:(0,f.t)("dialog.new.labels.original")})]})}),(0,r.jsxs)("div",{className:"field",children:[(0,r.jsx)("label",{htmlFor:"edit-brands",children:(0,f.t)("dialog.new.labels.brands")}),(0,r.jsx)(y.N,{inputId:"edit-brands",value:N,onChange:e=>selectBrands(e.value),onFocus:()=>q().catch(e=>{var t;P([]),E([]),null===(t=m.current)||void 0===t||t.show({severity:"error",summary:"".concat((0,f.t)("toast.summary.error")),detail:"".concat((0,f.t)("toast.details.error")),life:3e3})}),options:R,optionLabel:"brand",display:"chip",placeholder:(0,f.t)("dialog.new.placeholders.brands"),className:"w-full",disabled:!p.number})]}),(0,r.jsxs)("div",{className:"field",children:[(0,r.jsx)("label",{htmlFor:"edit-maxPrice",children:(0,f.t)("dialog.new.labels.max-price")}),(0,r.jsx)(v.R,{inputId:"edit-maxPrice",value:p.maxPrice,onValueChange:e=>onInputNumberChange(e,"maxPrice"),required:!0,mode:"decimal",maxFractionDigits:2,className:(0,b.AK)({"p-invalid":u&&!p.number})}),u&&!p.number&&(0,r.jsx)("div",{className:"text-sm p-invalid",children:(0,f.t)("dialog.new.errors.max-price")})]}),(0,r.jsxs)("div",{className:"field",children:[(0,r.jsx)("label",{htmlFor:"edit-maxDeliveryDays",children:(0,f.t)("dialog.new.labels.max-delivery-days")}),(0,r.jsx)(v.R,{inputId:"edit-maxDeliveryDays",value:p.maxDeliveryDays,onValueChange:e=>onInputNumberChange(e,"maxDeliveryDays"),required:!0,className:(0,b.AK)({"p-invalid":u&&!p.number})}),u&&!p.number&&(0,r.jsx)("div",{className:"text-sm p-invalid",children:(0,f.t)("dialog.new.errors.max-delivery-days")})]}),(0,r.jsxs)("div",{className:"field",children:[(0,r.jsx)("label",{htmlFor:"edit-minDeliveryRate",children:(0,f.t)("dialog.new.labels.min-delivery-rating")}),(0,r.jsx)(v.R,{inputId:"edit-minDeliveryRate",value:p.minDeliveryRate,onValueChange:e=>onInputNumberChange(e,"minDeliveryRate")})]}),(0,r.jsxs)("div",{className:"field",children:[(0,r.jsx)("label",{htmlFor:"edit-note",children:(0,f.t)("dialog.new.labels.note")}),(0,r.jsx)(j.g,{id:"edit-note",value:p.note?p.note:p.note=p.number,required:!0,rows:3,cols:20,onChange:e=>onInputChange(e,"note"),onClick:e=>e.currentTarget.select()})]})]})]})},delete_request=e=>{let{visible:t,onHide:a,onSubmit:n,onCancel:i}=e,{currentRequest:o,setCurrentRequest:l,deleteRequest:u,getEmptyRequest:h}=(0,w.useRequest)(),m=(0,d.useRef)(null),handleHide=()=>{l(h()),a()},handleDeleteRequest=async()=>{u().then(()=>l(h())).then(()=>n()).then(()=>handleHide()).then(()=>{var e;return null===(e=m.current)||void 0===e?void 0:e.show({severity:"success",summary:"".concat((0,f.t)("toast.summary.successful")),detail:"".concat((0,f.t)("toast.details.deleted")),life:3e3})}).catch(e=>{var t;null===(t=m.current)||void 0===t||t.show({severity:"error",summary:"".concat((0,f.t)("toast.summary.error")),detail:"".concat((0,f.t)("toast.details.error")),life:3e3})})},p=(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.z,{label:(0,f.t)("dialog.common.no"),icon:"pi pi-times",text:!0,onClick:()=>{handleHide(),i()}}),(0,r.jsx)(s.z,{label:(0,f.t)("dialog.common.yes"),icon:"pi pi-check",text:!0,onClick:handleDeleteRequest})]});return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(c.F,{ref:m,position:"bottom-right"}),(0,r.jsx)(x.V,{visible:t,style:{width:"450px"},header:(0,f.t)("dialog.delete.header"),modal:!0,footer:p,onHide:handleHide,children:(0,r.jsxs)("div",{className:"flex align-items-center justify-content-center",children:[(0,r.jsx)("i",{className:"pi pi-exclamation-triangle mr-3",style:{fontSize:"2rem"}}),o&&(0,r.jsxs)("span",{children:[(0,f.t)("dialog.delete.msg")," ",(0,r.jsx)("b",{children:o.number})," - ",(0,r.jsx)("b",{children:o.note}),"?"]})]})})]})},C=a(7805),page=()=>{let e=(0,g.useRouter)(),{t}=(0,p.$G)(),a=(0,d.useRef)(null),f=(0,d.useRef)(null),[x,b]=(0,d.useState)(""),[v,y]=(0,d.useState)(null),[j,q]=(0,d.useState)(!1),[R,E]=(0,d.useState)(!1),{requests:N,setRequests:P,fetchRequests:k,setCurrentRequest:S,setBrands:D,setSelectedBrands:T,updateStatus:F}=(0,w.useRequest)();(0,d.useEffect)(()=>{k()},[]);let updateRequest=e=>{S(e),e.number&&(null===e.brands&&(e.brands=[]),D(e.brands.map(e=>({brand:e}))),T(e.brands.map(e=>({brand:e})))),q(!0)},confirmDeleteRequest=e=>{S(e),E(!0)},findIndexById=e=>{let t=-1;for(let a=0;a<(null==N?void 0:N.length);a++)if(N[a].id===e){t=a;break}return t},onStatusChange=async e=>{var r,s,n;let i=[...N],o=(null===(r=e.target)||void 0===r?void 0:r.value)?findIndexById(e.target.value.toString()):-1,l={...i[o]};l.status=(null===(s=e.target)||void 0===s?void 0:s.checked)?"OPEN":"CLOSED",F(l),null===(n=a.current)||void 0===n||n.show({severity:"success",summary:"".concat(t("toast.summary.successful")),detail:"".concat(t("toast.details.status-changed",{number:l.number,status:l.status})),life:3e3})},I=(0,r.jsxs)("div",{className:"flex flex-column md:flex-row md:justify-content-between md:align-items-center",children:[(0,r.jsxs)("span",{className:"block mt-2 md:mt-0 p-input-icon-left",children:[(0,r.jsx)("i",{className:"pi pi-search"}),(0,r.jsx)(o.o,{id:"requests-filter",type:"search",onInput:e=>b(e.currentTarget.value),placeholder:t("common.input-search")})]}),(0,r.jsx)(s.z,{label:t("common.btn-new-request"),icon:"pi pi-plus",className:" mr-2",onClick:()=>q(!0)})]});return(0,r.jsx)("div",{className:"grid crud-homer",children:(0,r.jsx)("div",{className:"col-12",children:(0,r.jsxs)("div",{className:"card",hidden:null===N,children:[(0,r.jsx)(c.F,{ref:a,position:"bottom-right"}),(0,r.jsxs)(i.w,{ref:f,value:N,selection:v,onSelectionChange:e=>y(e.value),dataKey:"id",paginator:!0,rows:100,rowsPerPageOptions:[5,10,25,100],className:"datatable-responsive",paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",currentPageReportTemplate:t("table.pagination"),globalFilter:x,emptyMessage:t("table.common.no-request-found"),header:I,responsiveLayout:"scroll",size:"small",stripedRows:!0,showGridlines:!0,children:[(0,r.jsx)(n.s,{field:"status",body:e=>(0,r.jsx)(r.Fragment,{children:(0,r.jsx)(l.X,{inputId:"status-".concat(e.id),name:"status-".concat(e.id),onChange:e=>onStatusChange(e),checked:"OPEN"===e.status,value:e.id})})}),(0,r.jsx)(n.s,{sortable:!0,headerStyle:{minWidth:"8rem"},header:t("table.header.number"),headerTooltip:t("table.tooltips.number"),field:"number",body:e=>(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"flex align-items-center justify-content-left",children:[e.number,(0,r.jsx)("a",{href:"https://tehnomir.com.ua/index.php?r=product/search&SearchForm[code]=".concat(e.number),target:"_blank",rel:"noreferrer",children:(0,r.jsx)("i",{className:"pi pi-external-link ml-2",style:{fontSize:".75rem"}})}),(0,r.jsx)("a",{href:"#",onClick:()=>(navigator.clipboard.writeText(e.number),!1),children:(0,r.jsx)("i",{className:"pi pi-copy ml-2",style:{fontSize:".75rem"}})})]})})}),(0,r.jsx)(n.s,{sortable:!0,headerStyle:{minWidth:"2rem"},header:t("table.header.max-price"),headerTooltip:t("table.tooltips.max-price"),field:"maxPrice"}),(0,r.jsx)(n.s,{sortable:!0,headerStyle:{minWidth:"4rem"},header:t("table.header.last-min-price"),headerTooltip:t("table.tooltips.last-min-price"),field:"lastMinPrice",body:e=>(e.lastMinPrice,e.lastMinPrice,(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.u,{target:"#last-min-price-".concat(e.id),content:void 0===e.lastMinPrice||0===e.lastMinPrice?t("table.fields.no-last-min-price"):"".concat(t("table.fields.last-min-price-time")," ").concat((0,h.Z)(e.lastMinPriceTime).format("DD.MM.YYYY HH:mm:ss"))}),(0,r.jsx)(C.V,{id:"last-min-price-".concat(e.id),icon:void 0===e.lastMinPrice||0===e.lastMinPrice?"pi pi-exclamation-triangle":e.lastMinPrice>e.maxPrice?"pi pi-arrow-up":"pi pi-arrow-down",severity:void 0===e.lastMinPrice||0===e.lastMinPrice?"warning":e.lastMinPrice>e.maxPrice?"danger":null,value:void 0===e.lastMinPrice||0===e.lastMinPrice?t("table.fields.no-last-min-price"):e.lastMinPrice})]}))}),(0,r.jsx)(n.s,{sortable:!0,headerStyle:{minWidth:"4rem"},header:t("table.header.max-delivery-days"),headerTooltip:t("table.tooltips.max-delivery-days"),field:"maxDeliveryDays"}),(0,r.jsx)(n.s,{sortable:!0,headerStyle:{minWidth:"16rem"},header:t("table.header.note"),headerTooltip:t("table.tooltips.note"),field:"note"}),(0,r.jsx)(n.s,{sortable:!0,headerStyle:{minWidth:"2rem"},header:t("table.header.last-update"),headerTooltip:t("table.tooltips.last-update"),field:"updated",body:e=>(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(m.u,{target:"#created-and-last-update-".concat(e.id),content:"".concat(t("table.fields.created")," ").concat((0,h.Z)(e.created).format("DD.MM.YYYY HH:mm:ss"),"\n").concat(t("table.fields.last-update")," ").concat((0,h.Z)(e.updated).format("DD.MM.YYYY HH:mm:ss"))}),(0,r.jsx)("i",{id:"created-and-last-update-".concat(e.id),className:"created-and-last-update",children:(0,h.Z)(e.updated).fromNow()})]})}),(0,r.jsx)(n.s,{body:e=>(0,r.jsx)(r.Fragment,{children:(0,r.jsxs)("div",{className:"flex align-items-center justify-content-center",children:[(0,r.jsx)(s.z,{icon:"pi pi-pencil",size:"small",className:"mr-2",onClick:()=>updateRequest(e)}),(0,r.jsx)(s.z,{icon:"pi pi-trash",size:"small",severity:"danger",onClick:()=>confirmDeleteRequest(e)})]})}),align:"right",style:{minWidth:"2rem"}})]}),(0,r.jsx)(create_new_request,{visible:j,onHide:()=>q(!1),onSubmit:()=>u.s.getRequests().then(e=>P(e)).catch(t=>{e.push("/login")}),onCancel:()=>{}}),(0,r.jsx)(delete_request,{visible:R,onHide:()=>E(!1),onSubmit:()=>k(),onCancel:()=>{}})]})})})}},9621:function(e,t,a){"use strict";a.r(t),a.d(t,{RequestProvider:function(){return RequestProvider},useRequest:function(){return useRequest}});var r=a(7437),s=a(2265),n=a(2067),i=a.n(n),o=a(6282);let l=s.createContext(void 0),RequestProvider=e=>{let{children:t}=e,a={id:void 0,number:"",brands:[],maxPrice:.01,note:"",created:i()(),updated:i()(),status:"CLOSED",maxDeliveryDays:100,minDeliveryRate:0,notDamaged:!1,notUsed:!1,original:!1,returnable:!1,currency:"USD",lastMinPrice:0,lastMinPriceTime:i()()},[n,c]=(0,s.useState)([]),[d,u]=(0,s.useState)(a),[h,m]=(0,s.useState)([]),[p,g]=(0,s.useState)([]),fetchRequests=async()=>{await o.s.getRequests().then(e=>c(e)).catch(e=>{throw AggregateError(e,"Error fetching requests")})},saveRequest=async()=>{d&&(d.id?await o.s.updateRequest(d).then(()=>u(a)).then(()=>fetchRequests()):await o.s.createRequest(d).then(()=>u(a)).then(()=>fetchRequests()))},deleteRequest=async()=>{if(!d||!d.id)throw Error("Current request is not set");await o.s.deleteRequest(d).then(()=>fetchRequests())},fetchBrandsForCurrentRequest=async()=>{if(!d)throw Error("Current request is not set");await o.s.getAllBrandsByNumber(d.number).then(e=>m(e.map(e=>({brand:e}))))},updateStatus=async e=>{await o.s.updateStatus(e).then(()=>fetchRequests()).catch(e=>{throw AggregateError(e,"Error updating status")})};return(0,r.jsx)(l.Provider,{value:{requests:n,setRequests:c,currentRequest:d,setCurrentRequest:u,brands:h,setBrands:m,selectedBrands:p,setSelectedBrands:g,fetchRequests,saveRequest,deleteRequest,fetchBrandsForCurrentRequest,updateStatus,getEmptyRequest:()=>a},children:t})},useRequest=()=>{let e=s.useContext(l);if(!e)throw Error("useRequest must be used within a RequestProvider");return e}},2838:function(e,t,a){"use strict";var r=a(3968),s=a(2067),n=a.n(s);a(8890),a(5670),n().locale(r.ZP.language),t.Z=n()},6282:function(e,t,a){"use strict";a.d(t,{s:function(){return r}});let r={async getRequests(){let e=localStorage.getItem("token");if(!e)throw Error("Error: no token found");let t=await fetch("".concat("https://au-homer-fisher-go-953161734119.europe-west1.run.app/api","/requests"),{headers:{"Cache-Control":"no-cache","Content-Type":"application/json",Authorization:"Bearer ".concat(e)}});if(401===t.status)throw Error("Error: unauthorized");if(!t.ok)throw Error("Error: ".concat(t.statusText));let a=await t.json();return a},async deleteRequest(e){let t=localStorage.getItem("token");if(!t)throw Error("Error: no token found");let a=await fetch("".concat("https://au-homer-fisher-go-953161734119.europe-west1.run.app/api","/requests/").concat(e.id),{method:"DELETE",headers:{"Cache-Control":"no-cache","Content-Type":"application/json",Authorization:"Bearer ".concat(t)}});if(401===a.status)throw Error("Error: unauthorized");if(!a.ok)throw Error("Error: ".concat(a.statusText))},async updateStatus(e){let t=localStorage.getItem("token");if(!t)throw Error("Error: no token found");let a=await fetch("".concat("https://au-homer-fisher-go-953161734119.europe-west1.run.app/api","/requests/status/").concat(e.id),{method:"PUT",headers:{"Cache-Control":"no-cache","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(e)});if(401===a.status)throw Error("Error: unauthorized");if(!a.ok)throw Error("Error: ".concat(a.statusText))},async createRequest(e){let t=localStorage.getItem("token");if(!t)throw Error("Error: no token found");let a=await fetch("".concat("https://au-homer-fisher-go-953161734119.europe-west1.run.app/api","/requests"),{method:"POST",headers:{"Cache-Control":"no-cache","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(e)});if(401===a.status)throw Error("Error: unauthorized");if(!a.ok)throw Error("Error: ".concat(a.statusText))},async updateRequest(e){let t=localStorage.getItem("token");if(!t)throw Error("Error: no token found");let a=await fetch("".concat("https://au-homer-fisher-go-953161734119.europe-west1.run.app/api","/requests"),{method:"PUT",headers:{"Cache-Control":"no-cache","Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify(e)});if(401===a.status)throw Error("Error: unauthorized");if(!a.ok)throw Error("Error: ".concat(a.statusText))},async getAllBrandsByNumber(e){let t=localStorage.getItem("token");if(!t)throw Error("Error: no token found");let a=await fetch("".concat("https://au-homer-fisher-go-953161734119.europe-west1.run.app/api","/requests/").concat(e,"/brands"),{headers:{"Cache-Control":"no-cache","Content-Type":"application/json",Authorization:"Bearer ".concat(t)}});if(401===a.status)throw Error("Error: unauthorized");if(!a.ok)throw Error("Error: ".concat(a.statusText));let r=await a.json();return r}}}},function(e){e.O(0,[990,651,220,164,568,902,18,851,971,472,744],function(){return e(e.s=956)}),_N_E=e.O()}]);